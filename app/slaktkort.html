<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Släktkort</title>

  <style>
    /* =========================================================
       STYLING – Minimal, läsbar demosida
       - Ingen överdesign: fokus på testflöde och tydlighet
       ========================================================= */
    body { font-family: system-ui, Arial, sans-serif; padding: 24px; max-width: 900px; }
    a { display:inline-block; margin-bottom: 16px; }
    h1 { margin-bottom: 6px; }
    .muted { color:#555; }
    .card { border:1px solid #ddd; border-radius:10px; padding:16px; margin-top: 16px; }
    label { display:block; margin-top: 12px; font-weight: 700; }
    input, select, textarea, button { width:100%; padding:10px; margin-top:6px; font-size:1rem; }
    textarea { min-height: 90px; resize: vertical; }
    button { border:1px solid #333; background:#fff; cursor:pointer; margin-top: 16px; }
    .error { color:#b00020; font-weight: 800; }
    .ok { font-weight: 800; }
    code { background:#f4f4f4; padding:2px 6px; border-radius:6px; }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    @media (max-width: 700px) { .row { grid-template-columns: 1fr; } }

    /* =========================================================
       MINIKARTA – Klick-yta (inte Leaflet)
       - Demo: sätter lat/lon baserat på klickposition
       ========================================================= */
    .mapWrap { margin-top: 12px; }
    .mapHint { font-size: 0.95rem; margin-top: 6px; }
    .mapBox {
      height: 260px;
      border: 1px solid #ddd;
      border-radius: 10px;
      background: #f7f7f7;
      position: relative;
      overflow: hidden;
      user-select: none;
    }
    .pin {
      width: 12px;
      height: 12px;
      border-radius: 999px;
      border: 2px solid #111;
      background: #fff;
      position: absolute;
      transform: translate(-50%, -50%);
      display: none;
    }
    .mapLabel {
      position: absolute;
      left: 10px;
      top: 10px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid #ddd;
      background: #fff;
      font-size: 0.95rem;
    }
  </style>
</head>

<body>
  <a href="./index.html">← Tillbaka</a>

  <h1>Släktkort</h1>
  <p class="muted">
    Skapar ett släktkort i ett valt <code>tree</code>.
    Kräver att du är inloggad.
  </p>

  <!-- =========================================================
       1) TRÄDVAL
       - Hämtar trädlistan från backend (GET /trees)
       - Visar roll per träd (om backend skickar den)
       ========================================================= -->
  <div class="card">
    <h2>1) Välj släktträd</h2>
    <p class="muted">Listan hämtas från <code>GET /trees</code>.</p>

    <label for="treeSelect">Ditt släktträd</label>
    <select id="treeSelect"></select>

    <button id="reloadTreesBtn">Ladda om träd</button>
    <p id="treeMsg" class="muted" aria-live="polite"></p>
  </div>

  <!-- =========================================================
       2) SKAPA SLÄKTKORT
       - POST /trees/:treeId/slaktkort
       - Koordinater:
         * Manuell input: "lat, lon"
         * Minikarta: klick för att sätta ungefärlig position
       ========================================================= -->
  <div class="card">
    <h2>2) Skapa släktkort</h2>
    <p class="muted">Skapar via <code>POST /trees/:treeId/slaktkort</code>.</p>

    <div class="row">
      <div>
        <label for="fornamn">Förnamn</label>
        <input id="fornamn" placeholder="t.ex. Anna" />
      </div>
      <div
